let heightControl=()=>{document.documentElement.style.setProperty("--app-height",window.innerHeight+"px")},scrollPosition=0,bodyEl=document.querySelector("body");function disableScroll(){scrollPosition=window.pageYOffset,bodyEl.style.overflow="hidden",bodyEl.style.position="fixed",bodyEl.style.top=`-${scrollPosition}px`,bodyEl.style.width="100%"}function enableScroll(){bodyEl.style.removeProperty("overflow"),bodyEl.style.removeProperty("position"),bodyEl.style.removeProperty("top"),bodyEl.style.removeProperty("width"),window.scrollTo(0,scrollPosition)}function createNextButton(e,t,i){if(window.croakApp.buttonsParam)return i=document.querySelector(i).querySelector(".stories-next").cloneNode(),e.appendChild(e=i),e.classList.add("custom-right"),window.croakApp.activeSlide==t.getElementsByClassName("gallery__el").length-1&&(e.setAttribute("disabled","true"),e.classList.add("btn_disabled")),i}function createPrevButton(e,t){if(window.croakApp.buttonsParam)return t=document.querySelector(t).querySelector(".stories-prev").cloneNode(),e.appendChild(e=t),e.classList.add("custom-left"),0==window.croakApp.activeSlide&&(e.setAttribute("disabled","true"),e.classList.add("btn_disabled")),t}function createContainer(e){e&&(window.croakApp.buttonsParam=!0);let t=document.createElement("div");return document.body.append(t),t.classList.add("stories-container"),setTimeout(()=>{t.classList.add("stories-container_active")},100),t}function createElements(e,o,a,s,n){e.forEach(e=>{var t,i,r,l=document.createElement("div");n&&768<=window.innerWidth?(l.classList.add("gallery__el"),l.classList.add("gallery__el_stories")):l.classList.add("gallery__el"),l.style.setProperty("--img-scale",""+a),e.hasAttribute("data-video-el")?(t=document.createElement("video"),r=document.createElement("source"),i=document.createElement("source"),s&&(window.innerWidth<=768?(r.setAttribute("src",e.getAttribute("data-src-mob-mp4")),i.setAttribute("src",e.getAttribute("data-src-mob-webm")),t.muted=!0,t.style.width="100%",t.controls=!0):(r.setAttribute("src",e.getAttribute("data-src-mp4")),r.setAttribute("type","video/mp4"),i.setAttribute("src",e.getAttribute("data-src-webm")),i.setAttribute("type","video/webm"))),n&&(r.setAttribute("src",e.getAttribute("data-src-mob-mp4")),r.setAttribute("type","video/mp4"),i.setAttribute("src",e.getAttribute("data-src-mob-webm")),i.setAttribute("type","video/webm")),n||s||(r.setAttribute("src",e.getAttribute("data-src-mp4")),r.setAttribute("type","video/mp4"),i.setAttribute("src",e.getAttribute("data-src-webm")),i.setAttribute("type","video/webm")),t.setAttribute("loop","true"),t.setAttribute("playsinline","true"),t.appendChild(r),t.appendChild(i),t.setAttribute("preload","true"),l.append(t)):((r=document.createElement("img")).setAttribute("src",e.getAttribute("src")),l.append(r)),o.append(l)})}function createExitBtn(){var e=document.createElement("button"),t=(e.classList.add("close-gallery"),(new DOMParser).parseFromString('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.63599 18.364L18.3639 5.63603M5.63599 5.63604L18.3639 18.364" stroke="black" stroke-width="1.5" stroke-linecap="round"/></svg>',"image/svg+xml").querySelector("svg"));return e.append(t),e}function createGallery(e){var t=document.createElement("div");return t.classList.add("gallery"),t.style.setProperty("--gallery-gap",e),t.classList.add("gallery-opened"),t}var __awaiter=this&&this.__awaiter||function(e,a,s,n){return new(s=s||Promise)(function(i,t){function r(e){try{o(n.next(e))}catch(e){t(e)}}function l(e){try{o(n.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,l)}o((n=n.apply(e,a||[])).next())})};function remClassContainer(t){return new Promise(e=>{t.classList.remove("stories-container_active"),e()})}function remFromBody(e){document.body.removeChild(e)}function delContainer(e){return __awaiter(this,void 0,void 0,function*(){yield remClassContainer(e),setTimeout(()=>{remFromBody(e)},300)})}function deleteGallery(e,t,i,r,l,o,a){if(document.removeEventListener("keydown",l),document.removeEventListener("touchstart",o),document.removeEventListener("touchend",a),window.croakApp.activeSlide=void 0,delContainer(i),enableScroll(),r.classList.remove("gallery_transform"),window.croakApp.buttonsParam){l=r.parentElement.parentElement;let e=l.querySelector(".stories-prev"),t=l.querySelector(".stories-next");setTimeout(()=>{e.removeAttribute("disabled"),e.classList.remove("btn_disabled"),t.removeAttribute("disabled"),t.classList.remove("btn_disabled"),window.croakApp.buttonsParam=!1},300)}}function clickExit(e,t,i,r,l,o,a,s){e.addEventListener("click",()=>{deleteGallery(t,i,r,l,o,a,s)})}function clickGallery(r){let l=r.querySelectorAll(".gallery .gallery__el");document.querySelectorAll(".gallery .gallery__el").forEach((e,i)=>{e.addEventListener("click",e=>{l[window.croakApp.activeSlide].classList.remove("stories-el_active"),window.croakApp.activeSlide=i;var t,e=e.currentTarget;e.classList.add("stories-el_active"),gallerySwipe(e,r,!1),window.croakApp.buttonsParam&&(t=(e=r.parentElement.parentElement).querySelector(".stories-prev"),e=e.querySelector(".stories-next"),0==window.croakApp.activeSlide?(t.setAttribute("disabled","true"),t.classList.add("btn_disabled")):(t.removeAttribute("disabled"),t.classList.remove("btn_disabled")),window.croakApp.activeSlide==r.getElementsByClassName("gallery__el").length-1?(e.setAttribute("disabled","true"),e.classList.add("btn_disabled")):(e.removeAttribute("disabled"),e.classList.remove("btn_disabled")))})})}function gallerySwipe(e,o,t){var i=e.getBoundingClientRect().right,t=(e.parentElement.querySelectorAll("video").forEach(e=>{e.pause()}),void 0===t&&(t=!1),e.querySelector("video"));t&&e.classList.contains("stories-el_active")&&(t.setAttribute("autoplay","true"),t.play());t=o.getBoundingClientRect().width/2-i,i=o.getBoundingClientRect(),e=e.getBoundingClientRect();let a=-(t+i.left+e.width/2);o.style.transform=`translate3d(${-Math.round(a)}px, -50%, 0)`;var t=o.scrollWidth,i=o.parentElement,r=i.clientWidth;let l=0,s=!1,n=-a,d=0,c=0,p=r-t-e.width-e.width/2,u=-(t-r+e.width+e.width/2);function w(){window.croakApp.deskSwipeFocus&&o.querySelectorAll(".gallery__el").forEach((e,t,i)=>{var r,l;(l=(r=e).getBoundingClientRect().left+r.getBoundingClientRect().width/2)<=window.innerWidth/2+r.getBoundingClientRect().width/window.croakApp.elementScale/2&&l>=window.innerWidth/2-r.getBoundingClientRect().width/window.croakApp.elementScale/2&&(l=o.getBoundingClientRect().width/2-e.getBoundingClientRect().right,r=o.getBoundingClientRect(),e=e.getBoundingClientRect(),a=-(l+r.left+e.width/2),window.croakApp.activeSlide=t)}),setTimeout(()=>{o.classList.add("gallery_transform"),o.style.transform=`translate3d(${-Math.round(a)}px, -50%, 0)`;var e=o.getElementsByClassName("gallery__el")[window.croakApp.activeSlide];e.classList.add("stories-el_active"),e.querySelector("video")&&e.querySelector("video").play()},200),s=!1,o.style.cursor="grab",n=-d,c=0}768<=window.innerWidth&&window.croakApp.deskSwipe&&(i.addEventListener("mousedown",function(e){e.preventDefault(),o.querySelectorAll(".gallery__el").forEach((e,t,i)=>{e.querySelector("video")&&e.querySelector("video").pause()}),o.style.cursor="grabbing",s=!0,o.classList.remove("gallery_transform"),l=e.clientX}),i.addEventListener("mousemove",function(e){e.preventDefault(),s&&(0===c&&(n=-a,o.querySelectorAll(".gallery__el")[window.croakApp.activeSlide].classList.remove("stories-el_active"),c++),e=-(d=l-e.clientX-n),d<u&&(d+=e+(20+u)),e<p&&(d+=e-(p-20)),o.style.transform=`translate3d(${-d}px, -50%, 0)`)}),i.addEventListener("mouseup",w),i.addEventListener("mouseleave",w)),window.innerWidth<=768&&window.croakApp.deskSwipe&&o.classList.add("gallery_transform")}function nextClick(e){var t,i,r=e.querySelectorAll(".gallery .gallery__el"),l=e.querySelectorAll(".gallery .gallery__el").length;r[window.croakApp.activeSlide].classList.remove("stories-el_active"),window.croakApp.buttonsParam&&(i=e.parentElement.parentElement,window.croakApp.activeSlide<=1&&((t=i.querySelector(".stories-prev")).removeAttribute("disabled"),t.classList.remove("btn_disabled"),t.classList.add("stories-el_active")),window.croakApp.activeSlide===l-2)&&((t=i.querySelector(".stories-next")).setAttribute("disabled","true"),t.classList.add("btn_disabled")),window.croakApp.activeSlide<l-1&&(window.croakApp.activeSlide+=1,(i=r[window.croakApp.activeSlide]).classList.add("stories-el_active"),gallerySwipe(i,e))}function prevClick(e){var t,i,r,l=e.querySelectorAll(".gallery .gallery__el");window.croakApp.buttonsParam&&(r=e.querySelectorAll(".gallery .gallery__el").length,t=(i=e.parentElement.parentElement).querySelector(".stories-next"),i=i.querySelector(".stories-prev"),window.croakApp.activeSlide===r-1&&(t.removeAttribute("disabled"),t.classList.remove("btn_disabled")),1===window.croakApp.activeSlide)&&(i.setAttribute("disabled","true"),i.classList.add("btn_disabled")),l[window.croakApp.activeSlide].classList.remove("stories-el_active"),0!=window.croakApp.activeSlide&&(--window.croakApp.activeSlide,(r=l[window.croakApp.activeSlide]).classList.add("stories-el_active"),gallerySwipe(r,e,!1))}import{disableScroll}from"../appControl/scrollControl";class croakSlider{constructor(e){this.keyboard=!1,this.buttons=!1,this.gap="10px",this.scale=.75,this.opacity=.95,this.DOMElement="div[data-croak-container]",this.mobileVideo=!1,this.deskStories=!1,this.deskSwipeFocus=!1,this.deskSwipe=!1,this.clickGallery=!1,window.croakApp={activeSlide:void 0,buttonsParam:!1,elementScale:void 0,deskSwipe:!1,deskSwipeFocus:!1},this.keyboard=e.keyboard,this.buttons=e.buttons,this.gap=e.gap,this.scale=e.scale,this.opacity=e.opacity,this.DOMElement=e.DOMElement,this.mobileVideo=e.mobileVideo,this.deskStories=e.deskStories,this.deskSwipeFocus=e.deskSwipeFocus,this.deskSwipe=e.deskSwipe,this.clickGallery=e.clickGallery,e.DOMElement&&(this.DOMElement=e.DOMElement),e.buttons&&(window.croakApp.buttonsParam=!0,this.buttons=!0),e.keyboard&&(this.keyboard=e.keyboard),e.gap&&(this.gap=e.gap+"px"),e.scale&&(this.scale=e.scale,window.croakApp.elementScale=this.scale),e.opacity&&(this.opacity=e.opacity),!0===e.mobileVideo&&(this.mobileVideo=!0),!0===e.deskStories&&(this.deskStories=!0),!0===e.deskSwipe&&(window.croakApp.deskSwipe=!0),!0===e.deskSwipeFocus&&(window.croakApp.deskSwipeFocus=!0),!0===e.clickGallery&&(this.clickGallery=!0),this.DOMElement&&document.querySelectorAll(this.DOMElement).forEach(e=>{e.querySelectorAll("[data-el], [data-video-el]").forEach((e,c,p)=>{e.addEventListener("click",()=>{window.croakApp.activeSlide=c,setTimeout(()=>{disableScroll()},350);let i=createGallery(this.gap);createElements(p,i,this.scale,this.mobileVideo,this.deskStories);var e=createExitBtn();let t=createContainer(this.buttons);var r=document.createElement("div");r.classList.add("stories-wrapper"),this.deskStories||r.classList.add("gallery-fullsize"),t.appendChild(r),r.appendChild(i),t.appendChild(e),t.style.setProperty("--gallery-opacity",""+this.opacity),i&&(r=i.querySelectorAll(".gallery .gallery__el")[window.croakApp.activeSlide],i.querySelectorAll(".gallery .gallery__el")[window.croakApp.activeSlide].classList.add("stories-el_active"),gallerySwipe(r,i,this.deskSwipe),setTimeout(()=>{i.classList.add("gallery_transform")},200));let l=50,o=0,a=0;function s(e){o=e.touches[0].clientX,a=e.touches[0].clientY}function n(e){var t=e.changedTouches[0].clientX,e=e.changedTouches[0].clientY,t=o-t,e=a-e;0<Math.abs(t-e)&&Math.abs(t)>l&&(0<t?window.croakApp.activeSlide!==i.querySelectorAll(".gallery__el").length-1&&nextClick(i):t<0&&0!==window.croakApp.activeSlide&&prevClick(i))}function d(e){"ArrowRight"===e.key&&nextClick(i),"ArrowLeft"===e.key&&prevClick(i),"d"===e.key&&nextClick(i),"a"===e.key&&prevClick(i),"Escape"===e.key&&deleteGallery(o,a,t,i,d,s,n)}clickExit(e,o,a,t,i,d,s,n),this.buttons&&(r=createNextButton(t,i,this.DOMElement),e=createPrevButton(t,this.DOMElement),r.addEventListener("click",()=>{nextClick(i)}),e.addEventListener("click",()=>{prevClick(i)})),this.keyboard&&(document.addEventListener("keydown",d),window.innerWidth<=768)&&document.removeEventListener("keydown",d),document.addEventListener("touchstart",s),document.addEventListener("touchend",n),this.clickGallery&&clickGallery(i)})})})}}heightControl(),window.addEventListener("resize",heightControl);let frog=new croakSlider({DOMElement:"div[data-croak-container]",gap:"10",scale:.75,opacity:.95,deskStories:!0,deskSwipe:!0,deskSwipeFocus:!0,keyboard:!0});export{heightControl,disableScroll,enableScroll,createNextButton,createPrevButton,createContainer,createElements,createExitBtn,createGallery,delContainer,deleteGallery,clickExit,clickGallery,gallerySwipe,nextClick,prevClick,croakSlider};